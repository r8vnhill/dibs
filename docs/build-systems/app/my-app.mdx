---
title: Mi primera aplicaci√≥n
---
import ReadingTime from '@site/src/components/ReadingTime'
import { ProCons, Pros, Cons } from '@site/src/components/cajitas/ProCons'
import References from '@site/src/components/ReferencesComponent'
import Tabs from '@theme/Tabs'
import TabItem from '@theme/TabItem'
import Exercise from '@site/src/components/exercise/Exercise'
import Solution from '@site/src/components/exercise/Solution'
import Hint from '@site/src/components/exercise/Hint'
import Definition from '@site/src/components/Definition'
import Corollary from '@site/src/components/Corollary'
import GitHubRepoLink from '@site/src/components/git/GitHubRepoLink'
import { LanguageCard, BazelCard, CMakeCard, MavenCard, BuckCard } from '@site/src/components/cards/LanguageCard'
import Explanation from '@site/src/components/admonitions/Explanation'
import RepoClone from '@site/src/components/admonitions/RepoClone'

<ReadingTime />
<GitHubRepoLink user="r8vnhill" repo="echo-app-kt" />

Cuando desarrollamos software, no basta con escribir funciones en un archivo: necesitamos empaquetarlas, ejecutarlas, y eventualmente distribuirlas. Crear una **aplicaci√≥n ejecutable** es uno de los primeros pasos para transformar c√≥digo en una herramienta √∫til, accesible y reutilizable.

En esta lecci√≥n aprender√°s c√≥mo crear tu primera aplicaci√≥n ejecutable usando **Kotlin** y **Gradle**. Utilizaremos un ejemplo simple pero pr√°ctico: una peque√±a herramienta de l√≠nea de comandos que imprime mensajes con una marca de tiempo.

Aunque su funcionalidad es modesta, esta aplicaci√≥n te permitir√°:

- Configurar un proyecto Gradle desde cero.
- Integrar bibliotecas externas de manera declarativa.
- Empaquetar y ejecutar tu aplicaci√≥n desde la terminal.
- Comprender el papel del plugin `application` y su impacto en la distribuci√≥n.

Este recorrido sentar√° las bases para crear herramientas m√°s complejas en el futuro y te dar√° un primer vistazo a c√≥mo se ve una biblioteca de software cuando se convierte en una aplicaci√≥n lista para ejecutarse.

## üì¢ Echo App

La aplicaci√≥n que crearemos se llama **Echo App**. Su funci√≥n es simple: recibir un mensaje como argumento y mostrarlo
en la consola junto a la hora actual. Aunque la funcionalidad es b√°sica, nos permitir√° explorar c√≥mo configurar un
proyecto Gradle y ejecutar una aplicaci√≥n Kotlin.

### üì¶ Dependencias en detalle

Para expandir las funcionalidades de nuestro proyecto, vamos a a√±adir la biblioteca `kotlinx-datetime`, la cual nos
permitir√° trabajar con fechas y horas en Kotlin de manera eficiente. El primer paso ser√° actualizar el archivo
`libs.versions.toml` ubicado en la carpeta `gradle` con la nueva dependencia:

```toml title="./gradle/libs.versions.toml"
[versions]
# ...
kotlinx-datetime = "0.6.2"

[libraries]
# ...
kotlinx-datetime = { module = "org.jetbrains.kotlinx:kotlinx-datetime", version.ref = "kotlinx-datetime" }
```

Ahora, para asegurarnos de que todo est√© correctamente configurado y habilitar el autocompletado en el IDE, construye
el proyecto ejecutando el siguiente comando en tu terminal:

```bash
./gradlew build
```

Lo siguiente es decirle a Gradle d√≥nde debe buscar la nueva dependencia. Para ello, actualiza el archivo
`settings.gradle.kts` en la ra√≠z del proyecto para incluir el repositorio de MavenCentral:

```kotlin title="settings.gradle.kts"
// ...
dependencyResolutionManagement {    // Gesti√≥n de resoluci√≥n de dependencias
    @Suppress("UnstableApiUsage")   // Necesario para usar la API de resoluci√≥n de dependencias
    repositories {
        mavenCentral()  // Repositorio Maven Central
    }
}
```

Aqu√≠, hemos a√±adido `mavenCentral()` al bloque `repositories` para que Gradle pueda buscar la dependencia en Maven Central. Esto a√±adir√° el repositorio a todos los m√≥dulos del proyecto.

A continuaci√≥n, actualiza el archivo `build.gradle.kts` en el m√≥dulo `app` para incluir la nueva dependencia en el
bloque `dependencies`. Este bloque es donde definimos las bibliotecas que se utilizar√°n en el proyecto. Veamos qu√© tipo de dependencias puedes declarar en Gradle y c√≥mo afectan la compilaci√≥n y ejecuci√≥n del proyecto:

- `implementation`: Dependencias que ser√°n incluidas en la compilaci√≥n y el empaquetado de la aplicaci√≥n.
- `testImplementation`: Dependencias utilizadas √∫nicamente para las pruebas.
- `runtimeOnly`: Dependencias necesarias solo en tiempo de ejecuci√≥n, no durante la compilaci√≥n.
- `testRuntimeOnly`: Dependencias necesarias solo en tiempo de ejecuci√≥n de las pruebas.
- `compileOnly`: Dependencias utilizadas en tiempo de compilaci√≥n, pero no incluidas en tiempo de ejecuci√≥n.
- `testCompileOnly`: Dependencias para la compilaci√≥n de las pruebas, no necesarias en tiempo de ejecuci√≥n.
- `api`: Dependencias que se compilan y tambi√©n se exponen a otros m√≥dulos.
- `testApi`: Dependencias para pruebas que se exponen a otros m√≥dulos.

La sintaxis b√°sica para a√±adir una dependencia es la siguiente:

```kotlin
dependencies {
    implementation("group:artifact:version")
    implementation(group = "group", name = "artifact", version = "version")
    implementation(libs.artifact)
}
```

En nuestro caso, a√±adimos la dependencia de `kotlinx-datetime` a nuestro proyecto de la siguiente manera:

```kotlin title="app/build.gradle.kts"
dependencies {
    implementation(libs.kotlinx.datetime)
}
```

### üõ†Ô∏è Creando la aplicaci√≥n

Una vez que las dependencias est√°n configuradas, es momento de empezar a escribir el c√≥digo de nuestra aplicaci√≥n. El
primer paso es crear un nuevo paquete utilizando el nombre del grupo del proyecto seguido de `.echo` (por ejemplo,
`cl.ravenhill.echo`). Dentro de este paquete, crearemos un archivo llamado `EchoApp.kt` que contendr√° la l√≥gica
principal de la aplicaci√≥n.

El siguiente c√≥digo muestra c√≥mo construir nuestra aplicaci√≥n:

```kotlin title="./app/src/main/kotlin/cl/ravenhill/echo/EchoApp.kt"
package cl.ravenhill.echo

import kotlinx.datetime.Clock

fun echo(message: String) = "${Clock.System.now()} - $message"

fun main(args: Array<String>) {
    for (arg in args) {
        println(echo(arg))
    }
}
```

<Explanation>
    - Usamos `kotlinx.datetime.Clock` para obtener la hora actual y as√≠ agregar una marca de tiempo a los mensajes que se env√≠an como argumento.
    - La funci√≥n `echo()` toma un mensaje como par√°metro y devuelve una cadena con el mensaje acompa√±ado de la hora actual.
    - En la funci√≥n `main()`, se iteran los argumentos de la aplicaci√≥n (`args`), y para cada uno de ellos, se llama a la funci√≥n `echo()`.
</Explanation>

#### ‚öôÔ∏è Configuraci√≥n del plugin `application`

Para que nuestra aplicaci√≥n sea ejecutable con Gradle, necesitamos agregar el plugin `application` al archivo
`build.gradle.kts` en el m√≥dulo `app`. Este plugin nos permitir√° ejecutar la aplicaci√≥n mediante el comando
`./gradlew :app:run` y empaquetarla con `./gradlew :app:installDist`.

A√±ade el siguiente bloque al archivo `build.gradle.kts`:

```kotlin title="./app/build.gradle.kts"
plugins {
    // ...
    application
}

// ...

application {
    mainClass.set("cl.ravenhill.echo.EchoAppKt")
}
```

<Explanation>
    - Se aplica el plugin `application`.
    - Se define la clase principal que contiene la funci√≥n `main()` de nuestra aplicaci√≥n. En este caso, la clase generada por el compilador de Kotlin es `cl.ravenhill.echo.EchoAppKt`. El compilador agrega `Kt` al nombre de la clase, ya que es el nombre del archivo en el que est√° definida la funci√≥n `main()`.
</Explanation>

:::tip

Si tienes dudas sobre el nombre completo del main class, puedes compilar el proyecto y buscar el archivo `.class` generado en build/classes. Recuerda que Kotlin agrega el sufijo `Kt` al nombre del archivo si no es una clase.

:::

#### üöÄ Ejecutando la aplicaci√≥n

Para ejecutar la aplicaci√≥n, usa el siguiente comando en la terminal:

```bash
./gradlew :app:run --args "Hello, world!"
```

El resultado deber√≠a ser similar al siguiente:

```text
> Task :app:run
2024-09-08T18:35:20.469735500Z - Hello,
2024-09-08T18:35:20.479782500Z - world!
```

En este punto, has creado una aplicaci√≥n funcional que recibe argumentos y los imprime junto con una marca de tiempo.
Esto demuestra c√≥mo integrar una biblioteca externa (`kotlinx-datetime`) y c√≥mo configurar el proyecto para que sea
ejecutable con Gradle.

### ‚ö†Ô∏è El problema con `gradle run`

Aunque `gradle run` es una forma r√°pida y conveniente de ejecutar una aplicaci√≥n Kotlin durante el desarrollo, presenta algunas limitaciones importantes:

- **No permite pasar argumentos directamente desde la l√≠nea de comandos**: Para pasar argumentos, debemos usar `--args`, lo cual puede ser menos intuitivo.
- **No soporta input interactivo**: No se pueden recibir entradas directamente desde la consola mientras la aplicaci√≥n est√° en ejecuci√≥n.
- **Requiere que Gradle est√© instalado**: Cualquier persona que desee ejecutar la aplicaci√≥n deber√° tener Gradle instalado, lo cual no es ideal para distribuci√≥n a usuarixs finales.

Por estas razones, `gradle run` es m√°s √∫til para el desarrollo, pero no es la mejor opci√≥n cuando queremos distribuir nuestra aplicaci√≥n a usuarixs finales. Para crear un archivo ejecutable independiente de Gradle, podemos utilizar el comando `gradle installDist`.

```bash
./gradlew :app:installDist
```

Este comando genera un directorio `build/install/app`, que contiene un script de inicio que permite ejecutar la aplicaci√≥n sin necesidad de Gradle. Para ejecutar la aplicaci√≥n empaquetada, solo debes ejecutar el siguiente comando:

```bash
./app/build/install/app/bin/app "Hello," "world!"
```

Esto producir√° el mismo resultado que ejecutar `gradle run`, pero con la ventaja de que no depende de Gradle y puede distribuirse de manera m√°s sencilla.

### üéâ ¬°Felicidades!

Has creado tu primera aplicaci√≥n ejecutable en Kotlin, lista para distribuirse sin la necesidad de Gradle. Este es un paso importante para asegurar que tu aplicaci√≥n sea m√°s accesible para quienes la usen, ya que podr√°n ejecutarla de manera independiente.

## üéØ Conclusiones

Crear una aplicaci√≥n ejecutable puede parecer un desaf√≠o al principio, pero con las herramientas adecuadas y una estructura clara, se convierte en una tarea accesible y enriquecedora. En esta lecci√≥n, diste tus primeros pasos para convertir c√≥digo en una herramienta √∫til y compartible, utilizando Kotlin y Gradle como base tecnol√≥gica.

Este proceso no solo implica escribir funciones, sino tambi√©n aprender a:

- Configurar un entorno de construcci√≥n moderno y declarativo.
- Aprovechar bibliotecas externas para extender capacidades sin reinventar la rueda.
- Empaquetar la aplicaci√≥n para facilitar su distribuci√≥n.

M√°s all√° del ejemplo concreto, el verdadero valor est√° en comprender los principios que permiten crear software robusto y reutilizable.

### üîë Puntos clave

- **Gradle** es una herramienta poderosa para gestionar proyectos y dependencias en Kotlin.
- **El plugin `application`** transforma un m√≥dulo en una aplicaci√≥n ejecutable.
- **`kotlinx-datetime`** es una opci√≥n moderna y multiplataforma para trabajar con fechas y horas.
- **El empaquetado con `installDist`** permite crear versiones autoejecutables de la aplicaci√≥n sin depender de Gradle.
- **Distribuir aplicaciones** es un paso esencial para que otras personas puedan utilizar tu trabajo sin complicaciones t√©cnicas.

### üß∞ ¬øQu√© nos llevamos?

Crear una aplicaci√≥n ejecutable puede parecer una tarea sencilla, pero encierra muchas de las ideas fundamentales que aparecen en cualquier sistema de construcci√≥n: organizaci√≥n del c√≥digo, gesti√≥n de dependencias, configuraci√≥n del entorno de compilaci√≥n y empaquetado, y preparaci√≥n para su distribuci√≥n. En este ejercicio, esas ideas aparecen de forma pr√°ctica y concreta, sirviendo como punto de entrada a un conjunto m√°s amplio de herramientas y posibilidades.

A medida que avancemos en esta unidad, pasaremos de ejecutar una aplicaci√≥n a construir bibliotecas, automatizar tareas, definir configuraciones reutilizables y extender el comportamiento de Gradle. Pero todo ese camino parte de aqu√≠: de entender que, m√°s all√° de escribir c√≥digo, construir software implica tambi√©n saber c√≥mo empaquetarlo y compartirlo.

<div className="language-card-container">
    <CMakeCard link="/docs/build-systems/app/cmake" />
    <MavenCard link="/docs/build-systems/app/maven" />
    <BazelCard link="/docs/build-systems/app/bazel" />
    <BuckCard link="/docs/build-systems/app/buck" />
</div>

## üìñ Referencias

### üî• Recomendadas

üåê Get started with Gradle and Kotlin/JVM | Kotlin. (2024, septiembre 25). Kotlin Help. https://kotlinlang.org/docs/get-started-with-jvm-gradle-project.html
