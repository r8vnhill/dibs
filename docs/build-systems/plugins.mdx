---
title: Plugins
---

import ReadingTime from "../../src/components/ReadingTime";
import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

<ReadingTime/>

Como ya vimos en la [definición de plugin](./convention-plugins#plugin-def), un plugin es un componente de software que extiende la funcionalidad de Gradle.

Los plugins permiten la reutilización de configuraciones de build sin necesidad de duplicar código en múltiples proyectos.

## ¿Plugins o tareas?

Es importante diferenciar entre plugins y tareas en Gradle:

### Propósito

| **Tareas**                                                             | **Plugins**                                                                                                                   |
|------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------|
| Se utilizan para definir una acción específica dentro del build script | Son componentes reutilizables que pueden agregar y configurar múltiples tareas, extendiendo la funcionalidad del build script |
| Componentes individuales que realizan trabajos concretos               | Los plugins encapsulan lógica y configuración que puede aplicarse a uno o más proyectos                                       |

### Alcance

| **Tareas**                                                                 | **Plugins**                                                                                                                                                          |
|----------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Tienen un alcance limitado al build script o proyecto en el que se definen | Tienen un alcance más amplio, ya que pueden aplicarse a múltiples proyectos y pueden incluir lógica para configurar y extender esos proyectos de manera más compleja |
| Son específicas a una parte del proceso de construcción                    | Pueden abarcar múltiples aspectos del proceso de construcción y configuración                                                                                        |


## Plugins predefinidos

Gradle proporciona una serie de plugins predefinidos que se pueden aplicar a un proyecto para agregar funcionalidades
comunes. Algunos de los plugins más utilizados son:

- `kotlin`, `java`, `scala` y `groovy`: Agregan soporte para proyectos en los lenguajes respectivos.
- `application`: Permite crear un ejecutable de la aplicación.
- `` `java-library` ``: Configura un proyecto como una biblioteca Java.
- `jacoco`: Agrega soporte para la generación de informes de cobertura de código.
- `` `maven-publish` ``: Permite publicar artefactos en un repositorio Maven.

## Aplicación de plugins

Gradle ofrece varias formas de aplicar plugins en el bloque `plugins`. A continuación, se presentan los métodos más
comunes:

### Aplicación directa
#### Aplicación por ID con versión

Esta es la forma más habitual de aplicar un plugin, especificando su ID y versión:

<Tabs>
    <TabItem value="Kotlin DSL" label="Kotlin DSL">
    ```kotlin
    plugins {
        id("some.plugin") version "1.0.0"
    }
    ```
    </TabItem>
    <TabItem value="Groovy DSL" label="Groovy DSL">
    ```groovy
    plugins {
        id 'some.plugin' version '1.0.0'
    }
    ```
    </TabItem>
</Tabs>

#### Aplicación por ID sin versión

Si gestionas las versiones de los plugins en un archivo centralizado como `libs.versions.toml`, puedes omitir la
versión directamente en el bloque `plugins`. Este es el método recomendado para proyectos que usan una gestión
centralizada de versiones:

```kotlin
plugins {
    id("some.plugin")
}
```

#### Uso de alias para plugins (desde `libs.versions.toml`)

Gradle también permite definir alias en un archivo `libs.versions.toml` para simplificar la declaración de los plugins:

```kotlin
plugins {
    alias(libs.plugins.some.plugin)
}
```

#### Aplicación por nombre "simple"

Algunos plugins integrados de Gradle, como `java-library` o `application`, pueden aplicarse de manera más concisa
utilizando su nombre directamente. Si el nombre del plugin contiene caracteres especiales, como guiones (`-`), usa
comillas invertidas:

```kotlin
plugins {
    `java-library`  // Con comillas invertidas debido al guion
    application     // Sin comillas porque no contiene caracteres especiales
}
```

#### Aplicación mediante funciones específicas (Kotlin DSL)

Algunos plugins, como el de Kotlin, tienen funciones específicas en Kotlin DSL, lo que mejora la legibilidad y
facilita el uso de diferentes configuraciones dentro del mismo bloque:

```kotlin
plugins {
    kotlin("jvm") version "1.6.21"
}
```

---

Estas son las principales formas de aplicar plugins en Gradle usando el bloque `plugins`. El uso de alias y la gestión
centralizada de versiones en `libs.versions.toml` es recomendable para mantener una consistencia en la versión de los
plugins en proyectos grandes.

### Aplicación mediante `apply`

El método `apply` es útil en algunas situaciones específicas, como cuando necesitas aplicar un plugin condicionalmente
o cuando trabajas con **plugins personalizados definidos como clases** dentro de tu proyecto. Aunque el bloque
`plugins` es la forma recomendada y moderna de aplicar plugins, `apply` es necesario para algunos casos específicos.

#### Aplicación de un plugin con `apply`

Puedes aplicar un plugin utilizando la sintaxis `apply(plugin = "id.del.plugin")`:

```kotlin
apply(plugin = "java")  // Aplica el plugin 'java' al proyecto
```

En Groovy DSL, el equivalente sería:

```groovy
apply plugin: 'java'
```

#### Aplicación de plugins personalizados

Si has definido un **plugin personalizado** como una **clase** en tu proyecto (por ejemplo, dentro de `buildSrc` o
como parte de otro módulo), necesitarás usar `apply` para aplicarlo. Aquí tienes un ejemplo de cómo hacerlo:

```kotlin
apply(plugin = "com.example.custom-plugin")  // Aplica un plugin personalizado definido como clase
```

Sin embargo, si defines un **plugin personalizado en un archivo `*.gradle.kts`** dentro de un módulo como
`convention-plugins`, puedes utilizar el bloque `plugins` para aplicarlo, de la misma manera que aplicas otros plugins
predefinidos:

```kotlin
plugins {
    id("com.example.convention-plugin")  // Plugin personalizado en archivo *.gradle.kts
}
```

#### Diferencias entre `apply` y el bloque `plugins`

| **Característica**                             | **Bloque `plugins`**                                                             | **Método `apply`**                                 |
|------------------------------------------------|----------------------------------------------------------------------------------|----------------------------------------------------|
| **Validación en tiempo de configuración**      | Sí. Detecta errores de configuración al inicio.                                  | No. La validación ocurre en tiempo de ejecución.   |
| **Compatibilidad con repositorios de plugins** | Sí. Se integra directamente con el portal de plugins de Gradle.                  | No. Requiere que los plugins ya estén disponibles. |
| **Aplicación condicional**                     | No. Es más declarativo y estático.                                               | Sí. Permite lógica condicional dentro del script.  |
| **Soporte para plugins personalizados**        | Sí, si el plugin está en un archivo `*.gradle.kts` como en `convention-plugins`. | Necesario para plugins definidos como clases.      |
| **Versiones**                                  | Se pueden omitir si se gestionan en un archivo `libs.versions.toml`.             | La versión puede gestionarse de otras formas.      |

#### Ejemplo de uso condicional con `apply`

Una ventaja del método `apply` es que puedes usarlo para aplicar un plugin condicionalmente dentro de un bloque de
lógica. En este ejemplo, solo aplicamos el plugin si una propiedad específica está presente:

```kotlin
if (project.hasProperty("includeJava")) {
    apply(plugin = "java")
}
```

En este caso, el plugin `java` solo se aplica si se ha definido la propiedad `includeJava` al ejecutar el script.

#### Limitaciones de `apply`

Aunque `apply` puede ser útil para aplicaciones condicionales y dinámicas, tiene algunas limitaciones en comparación
con el bloque `plugins`:

- No ofrece la misma validación en tiempo de configuración.
- No está integrado directamente con el repositorio de plugins de Gradle, por lo que requiere que los plugins estén
    disponibles de otra manera.
- No es compatible con la resolución de versiones centralizada de forma automática, lo que puede hacer que la gestión
    de versiones de plugins en proyectos grandes sea más compleja.

### ¿Cuándo usar `apply`?

- **Plugins personalizados como clases**: `apply` es necesario cuando defines tus propios plugins como clases en el
    proyecto (por ejemplo, dentro de `buildSrc` o en módulos locales).
- **Aplicación condicional**: Útil cuando necesitas aplicar plugins basados en ciertas condiciones.
- **Proyectos antiguos**: Puede encontrarse en proyectos antiguos que todavía usan `apply`.

Para la mayoría de los casos modernos, el bloque `plugins` es preferible debido a su simplicidad, validación y mejor
integración con el ecosistema de Gradle. Sin embargo, si trabajas con plugins personalizados definidos como clases,
`apply` es la opción requerida.
