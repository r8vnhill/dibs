import Tooltip from "../../../components/Tooltip";

# JVM: Spock

**Spock** es un framework de pruebas y especificaciones escrito en **Groovy** para Java y Groovy que se destaca por su sintaxis expresiva y su enfoque basado BDD utilizando en el patrón <Tooltip text={<>Este patrón es equivalente a <code>BehaviorSpec</code> en Kotest</>} highlight={true}>`given-when-then`</Tooltip>. A continuación, exploraremos cómo se realiza el testing de excepciones en **Spock** y compararemos las similitudes y diferencias con **Kotest** en Kotlin.

## Ejemplo en Spock

En este ejemplo, se muestra cómo **Spock** permite probar excepciones lanzadas por un método que modifica la salud de un Bakémon:

```groovy showLineNumbers title="BakemonHpSpec.groovy"
import spock.lang.Specification

class BakemonHpSpec extends Specification {

    def "should throw exception when health points are set below zero"() {
        given: "a Bakémon with maximum health"
        Bakemon bakemon = new Bakemon("Bigachu", 100)

        when: "setting current health points to a negative value"
        bakemon.setCurrentHealthPoints(-1)

        then: "an IllegalArgumentException is thrown"
        thrown(IllegalArgumentException)
    }
}
```

## Similitudes entre Kotest y Spock

1. **Expresividad**: Ambos frameworks ofrecen un enfoque declarativo para probar excepciones, lo que permite escribir tests que sean legibles y enfocados en el comportamiento.

2. **Verificación de Excepciones**: Tanto Kotest como Spock permiten verificar de forma explícita que se lance una excepción específica y su mensaje asociado. En **Kotest** se usa `shouldThrow`, mientras que en **Spock** se utiliza `thrown`.

3. **Testing fluido**: Ambos frameworks utilizan una sintaxis fluida y expresiva, lo que facilita la creación de pruebas comprensibles. En **Spock**, el flujo de prueba se organiza en bloques (`given`, `when`, `then`), mientras que **Kotest** organiza las pruebas de forma fluida mediante estilos de especificación.

## Diferencias entre Kotest y Spock

1. **Lenguaje de Programación**:
    - **Kotest**: Está diseñado específicamente para **Kotlin**, aprovechando la concisa y expresiva sintaxis del lenguaje.
    - **Spock**: Funciona en **Groovy**, pero también es compatible con **Java**, por lo que es más adecuado para proyectos basados en **Java** y con desarrolladores familiarizados con **Groovy**.

2. **Estilo de Estructuración**:
    - **Kotest**: Ofrece varios estilos de especificación (`StringSpec`, `FreeSpec`, `BehaviorSpec`, etc.) para organizar las pruebas de forma flexible.
    - **Spock**: Sigue el patrón `given-when-then`, lo que permite estructurar las pruebas de manera narrativa, pero menos flexible en comparación con Kotest.

3. **Verificación de Excepciones**:
    - **Kotest**: Proporciona varios métodos para testear excepciones (`shouldThrow`, `shouldThrowExactly`, etc.), lo que permite controlar el nivel de exactitud en la verificación de excepciones.
    - **Spock**: Utiliza `thrown` para verificar excepciones, pero sin la granularidad que proporciona Kotest para verificar la clase exacta de excepción o aceptar subclases.

## Comparación Final: Kotest vs Spock

| **Característica**              | **Kotest**                                              | **Spock**                                        |
|---------------------------------|---------------------------------------------------------|--------------------------------------------------|
| **Lenguaje**                    | Kotlin                                                  | Groovy (también compatible con Java)             |
| **Verificación de Excepciones** | `shouldThrow`, `shouldThrowExactly`, `shouldThrowAny`   | `thrown(IllegalArgumentException)`               |
| **Estilo de Pruebas**           | Diversos estilos de especificación (e.g., `FreeSpec`)   | `given-when-then`                                |
| **Control de Excepciones**      | Verificación exacta y flexible con `shouldThrowExactly` | Menos granular, pero declarativo y fácil de leer |
| **Sintaxis Fluida**             | Altamente fluida con varios estilos de especificación   | Narrativo con bloques (`given`, `when`, `then`)  |
